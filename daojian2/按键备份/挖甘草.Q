[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=4bf5f131-9849-4e2f-9fb6-3fba593c3de0
Description=挖甘草
Enable=0
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=2
QUI=
[Relative]
SetupOCXFile=
[Comment]

[Attachment]
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


[Script]
Hwnd = Plugin.Window.Find("pg_gui_window_default_class[13680]", "夏禹剑 - 刀剑2")
Delay 1000

// 聊天切换到队伍模式，防止识图到拾取记录

UserVar counter=0 "挖次数"
UserVar maxGather=180 "总挖次数"

// 屏幕分辨率参数
UserVar screenWidth=2560 "屏幕宽度"
UserVar screenHight=1440 "屏幕高度"

// 导航所在
UserVar navigationX =2358 "导航所在"
UserVar navigationY =1267 "导航所在"

UserVar isCollect = False "为 True 则捡过东西"

// 上马
Function mountHorse(tag)
	isCollect = False
	Delay 300
	MoveTo 1357, 1304
	Delay 20
	LeftClick 1
	Delay 5000
End Function

// 采集
Function gather(tag)
	KeyPress "Num 5", 1
	Delay 100
	KeyPress "Num 2", 1
	//KeyPress "Num 4", 5// 左旋
	Delay 300
	k=0
	j=0
	i= 0
	While i < 10
		Delay 150
    	FindPic 0, 0, screenWidth, screenHight, "C:\Users\Administrator\Documents\dao2\gancao.bmp", 0.6, intX, intY
		//FindPic 0, 0, 2560, 1440, "C:\Users\Administrator\Documents\dao2\dahuang.bmp", 0.5, intX, intY
		
		If intX > 0 And intY > 0 Then 
			MoveTo intX + 20, intY + 50
			TracePrint "找到图形，鼠标已经移到图形上面"
			//MessageBox "找到图形，鼠标已经移到图形上面"
			say("挖" & counter)
			Delay 50
			LeftClick 1
			Delay 100
			MoveTo 100, 100
			Delay 5200
			counter = counter + 1
			// 换锄头
			If counter = 50 Then 
				KeyPress "1", 1
			End If
			If counter = 100 Then 
				KeyPress "2", 1
			End If
			isCollect = True
		Else 
			//MessageBox "未找到图形"
			j= j+1
			TracePrint "未找到图形"
			If j < 3 Then  
				//KeyPress "Num 8", 1// 降低摄像头
				//Delay 50
				KeyPress "Num 4", 1
				k=k+1
			End If
			Delay 300
			i = i+1
		End If
	Wend
	
	For k
		say("摄像头归位" & k)
		Delay 50
		KeyPress "Num 6", 1
	Next

End Function

// 土遁去碎木
Function gotoSuiMu(tag)
	Delay 20
	MoveTo 1407, 1295
	LeftClick 1
	Delay 20
	MoveTo 1250, 902
	LeftClick 1
	Delay 20
	MoveTo 1392, 953
	LeftClick 1
	Delay 20
	MoveTo 1199, 756
	LeftClick 1
	Delay 6000
	KeyPress "W", 1
	Delay 1000
End Function

// 打开导航
Function openNavigation(tag)
	Delay 20
	MoveTo navigationX,navigationY
	Delay 20
	LeftClick 1
End Function

// 导航输入框,输入坐标寻路
Function gotoLocation(xy)
	Delay 30
	MoveTo 2407, 1143
	Delay 30
	LeftClick 1
	
	// 删除坐标
	Delay 30
	KeyPress "BackSpace", 20
	// 输入坐标
	SayString xy
	Delay 20
	KeyPress "Enter", 1    
End Function

Function say(txt)
	now=Plugin.GetSysInfo.GetDateTime()    
	TracePrint now & "：" & txt
	KeyPress "Enter", 1
	SayString now & "：" & txt
	KeyPress "Enter", 1
End Function


// 打开
openNavigation (0)


While counter < maxGather

	KeyPress "Ctrl", 1

    // 前往第一点
	gotoLocation ("646,848")
	Delay 13000
	gather (0)
	
	
	// 前往第二点
	gotoLocation ("641,941")
	Delay 14000
	gather (0)
	
	// 前往第三点
	gotoLocation ("646,963")
	Delay 14000
	gather (0)
	
	// 前往第4点
	gotoLocation ("687,1054")
	Delay 28000
	gather (0)
	
	// 前往第5点
	KeyPress "Ctrl", 1
	gotoLocation ("792,1053")
	Delay 22000
	gather (0)
	
	//去碎木
	gotoSuiMu(0)
Wend

MessageBox "脚本结束"
